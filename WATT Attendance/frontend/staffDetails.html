<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Staff Details</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

  <style>
    .details-container {
      display: flex;
      gap: 2rem;
      align-items: flex-start;
      margin-top: 1rem;
    }

    .staff-info {
      flex: 2;
    }

    .profile-frame {
      width: 20rem;
      height: 25rem;
      border: 3px solid #ddd;
      border-radius: 0.5rem;
      overflow: hidden;
      background-color: #f8f9fa;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .profile-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .info-grid p {
      margin-bottom: 0;
    }

    .info-item {
      display: flex;
      flex-direction: column;
    }
  </style>
</head>

<body class="bg-light">
  <div class="container mt-4">
    <!-- Header with Name + Buttons -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 id="staffName"></h2>
      <div class="d-flex gap-2">
        <a id="editStaff" class="btn btn-warning"><i class="bi bi-pencil-square"></i> Edit</a>
        <button id="deleteStaff" class="btn btn-danger"><i class="bi bi-trash"></i> Delete</button>
      </div>
    </div>

    <div class="details-container">
      <!-- Profile Frame -->
      <div class="profile-frame">
        <img id="profilePhoto" src="https://via.placeholder.com/300" alt="Staff Photo">
        <button class="btn btn-outline-primary mt-3" onclick="document.getElementById('uploadPhoto').click()">
          <i class="bi bi-camera"></i> Change Photo
        </button>
        <input type="file" id="uploadPhoto" accept="image/*" style="display: none;">
      </div>

      <!-- Staff Information -->
      <div class="staff-info">
        <h3 class="mb-3">Personal Information</h3>
        <div class="info-grid">
          <div class="info-item"><strong>Staff ID:</strong><span id="staffId"></span></div>
          <div class="info-item"><strong>Gender:</strong><span id="gender"></span></div>
          <div class="info-item"><strong>Date of Birth:</strong><span id="dob"></span></div>
          <div class="info-item"><strong>Marital Status:</strong><span id="maritalStatus"></span></div>
          <div class="info-item"><strong>Email:</strong><span id="email"></span></div>
          <div class="info-item"><strong>Personal Contact:</strong><span id="personalContact"></span></div>
          <div class="info-item"><strong>Alternative Contact:</strong><span id="altContact"></span></div>
          <div class="info-item"><strong>Address:</strong><span id="address"></span></div>
          <div class="info-item"><strong>City:</strong><span id="city"></span></div>
          <div class="info-item"><strong>State:</strong><span id="state"></span></div>
          <div class="info-item"><strong>Pincode:</strong><span id="pincode"></span></div>
        </div>

        <h3 class="mt-4 mb-3">Family Information</h3>
        <div class="info-grid">
          <div class="info-item"><strong>Father's Name:</strong><span id="fatherName"></span></div>
          <div class="info-item"><strong>Mother's Name:</strong><span id="motherName"></span></div>
        </div>

        <h3 class="mt-4 mb-3">Job Information</h3>
        <div class="info-grid">
          <div class="info-item"><strong>Joining Date:</strong><span id="joiningDate"></span></div>
          <div class="info-item"><strong>Job Title:</strong><span id="jobTitle"></span></div>
          <div class="info-item"><strong>Department:</strong><span id="department"></span></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let staff = JSON.parse(localStorage.getItem('currentStaff'));
    if (!staff) {
      alert("No staff selected!");
      window.history.back();
    }

    // Update Title
    document.title = staff.fullName ? Staff Details - ${staff.fullName} : 'Staff Details';

    // Fill Details
    function fillStaffDetails(s) {
      document.getElementById("staffName").innerText = s.fullName || '';
      document.getElementById("staffId").innerText = s.staffId || '';
      document.getElementById("fatherName").innerText = s.fatherName || '';
      document.getElementById("motherName").innerText = s.motherName || '';
      document.getElementById("dob").innerText = s.dob || '';
      document.getElementById("gender").innerText = s.gender || '';
      document.getElementById("maritalStatus").innerText = s.maritalStatus || '';
      document.getElementById("email").innerText = s.email || '';
      document.getElementById("personalContact").innerText = s.personalContact || '';
      document.getElementById("altContact").innerText = s.altContact || '';
      document.getElementById("address").innerText = s.address || '';
      document.getElementById("city").innerText = s.city || '';
      document.getElementById("state").innerText = s.state || '';
      document.getElementById("pincode").innerText = s.pincode || '';
      document.getElementById("joiningDate").innerText = s.joiningDate || '';
      document.getElementById("jobTitle").innerText = s.jobTitle || '';
      document.getElementById("department").innerText = s.department || '';
      if (s.photo) document.getElementById("profilePhoto").src = s.photo;
    }
    fillStaffDetails(staff);

    // Edit Staff
    document.getElementById("editStaff").addEventListener("click", function () {
      window.location.href = 'addStaff.html?id=' + staff.staffId;
    });

    // Delete Staff
    document.getElementById("deleteStaff").addEventListener("click", function () {
      if (confirm('Are you sure you want to delete this staff?')) {
        let staffList = JSON.parse(localStorage.getItem('staffList')) || [];
        staffList = staffList.filter(s => s.staffId !== staff.staffId);
        localStorage.setItem('staffList', JSON.stringify(staffList));
        localStorage.removeItem('currentStaff');
        window.location.href = 'staff.html';
      }
    });

    // Upload Photo
    document.getElementById("uploadPhoto").addEventListener("change", function (event) {
      const reader = new FileReader();
      reader.onload = function () {
        document.getElementById("profilePhoto").src = reader.result;
        staff.photo = reader.result;
        let staffList = JSON.parse(localStorage.getItem('staffList')) || [];
        const idx = staffList.findIndex(s => s.staffId == staff.staffId);
        if (idx > -1) {
          staffList[idx] = staff;
          localStorage.setItem('staffList', JSON.stringify(staffList));
        }
        localStorage.setItem('currentStaff', JSON.stringify(staff));
      };
      reader.readAsDataURL(event.target.files[0]);
    });
  </script>
</body>

</html>